import"https://cdn.video-dns.com/npm/@maveio/components/+esm";class w extends Error{constructor(e,t,s){const o=e.status||e.status===0?e.status:"",n=e.statusText||"",u=`${o} ${n}`.trim(),i=u?`status code ${u}`:"an unknown error";super(`Request failed with ${i}`),Object.defineProperty(this,"response",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="HTTPError",this.response=e,this.request=t,this.options=s}}class C extends Error{constructor(e){super("Request timed out"),Object.defineProperty(this,"request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name="TimeoutError",this.request=e}}const h=r=>r!==null&&typeof r=="object",d=(...r)=>{for(const e of r)if((!h(e)||Array.isArray(e))&&typeof e<"u")throw new TypeError("The `options` argument must be an object");return y({},...r)},R=(r={},e={})=>{const t=new globalThis.Headers(r),s=e instanceof globalThis.Headers,o=new globalThis.Headers(e);for(const[n,u]of o.entries())s&&u==="undefined"||u===void 0?t.delete(n):t.set(n,u);return t},y=(...r)=>{let e={},t={};for(const s of r)if(Array.isArray(s))Array.isArray(e)||(e=[]),e=[...e,...s];else if(h(s)){for(let[o,n]of Object.entries(s))h(n)&&o in e&&(n=y(e[o],n)),e={...e,[o]:n};h(s.headers)&&(t=R(t,s.headers),e.headers=t)}return e},E=(()=>{let r=!1,e=!1;const t=typeof globalThis.ReadableStream=="function",s=typeof globalThis.Request=="function";return t&&s&&(e=new globalThis.Request("https://a.com",{body:new globalThis.ReadableStream,method:"POST",get duplex(){return r=!0,"half"}}).headers.has("Content-Type")),r&&!e})(),O=typeof globalThis.AbortController=="function",A=typeof globalThis.ReadableStream=="function",P=typeof globalThis.FormData=="function",x=["get","post","put","patch","head","delete"],M={json:"application/json",text:"text/*",formData:"multipart/form-data",arrayBuffer:"*/*",blob:"*/*"},v=2147483647,k=Symbol("stop"),I=r=>x.includes(r)?r.toUpperCase():r,j=["get","put","head","delete","options","trace"],$=[408,413,429,500,502,503,504],q=[413,429,503],g={limit:2,methods:j,statusCodes:$,afterStatusCodes:q,maxRetryAfter:Number.POSITIVE_INFINITY,backoffLimit:Number.POSITIVE_INFINITY},U=(r={})=>{if(typeof r=="number")return{...g,limit:r};if(r.methods&&!Array.isArray(r.methods))throw new Error("retry.methods must be an array");if(r.statusCodes&&!Array.isArray(r.statusCodes))throw new Error("retry.statusCodes must be an array");return{...g,...r,afterStatusCodes:q}};async function N(r,e,t){return new Promise((s,o)=>{const n=setTimeout(()=>{e&&e.abort(),o(new C(r))},t.timeout);t.fetch(r).then(s).catch(o).then(()=>{clearTimeout(n)})})}const L=!!globalThis.DOMException;function T(r){if(L)return new DOMException((r==null?void 0:r.reason)??"The operation was aborted.","AbortError");const e=new Error((r==null?void 0:r.reason)??"The operation was aborted.");return e.name="AbortError",e}async function F(r,{signal:e}){return new Promise((t,s)=>{if(e){if(e.aborted){s(T(e));return}e.addEventListener("abort",o,{once:!0})}function o(){s(T(e)),clearTimeout(n)}const n=setTimeout(()=>{e==null||e.removeEventListener("abort",o),t()},r)})}class f{static create(e,t){const s=new f(e,t),o=async()=>{if(s._options.timeout>v)throw new RangeError(`The \`timeout\` option cannot be greater than ${v}`);await Promise.resolve();let i=await s._fetch();for(const a of s._options.hooks.afterResponse){const l=await a(s.request,s._options,s._decorateResponse(i.clone()));l instanceof globalThis.Response&&(i=l)}if(s._decorateResponse(i),!i.ok&&s._options.throwHttpErrors){let a=new w(i,s.request,s._options);for(const l of s._options.hooks.beforeError)a=await l(a);throw a}if(s._options.onDownloadProgress){if(typeof s._options.onDownloadProgress!="function")throw new TypeError("The `onDownloadProgress` option must be a function");if(!A)throw new Error("Streams are not supported in your environment. `ReadableStream` is missing.");return s._stream(i.clone(),s._options.onDownloadProgress)}return i},u=s._options.retry.methods.includes(s.request.method.toLowerCase())?s._retry(o):o();for(const[i,a]of Object.entries(M))u[i]=async()=>{s.request.headers.set("accept",s.request.headers.get("accept")||a);const m=(await u).clone();if(i==="json"){if(m.status===204||(await m.clone().arrayBuffer()).byteLength===0)return"";if(t.parseJson)return t.parseJson(await m.text())}return m[i]()};return u}constructor(e,t={}){if(Object.defineProperty(this,"request",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"abortController",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_retryCount",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_input",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_options",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._input=e,this._options={credentials:this._input.credentials||"same-origin",...t,headers:R(this._input.headers,t.headers),hooks:y({beforeRequest:[],beforeRetry:[],beforeError:[],afterResponse:[]},t.hooks),method:I(t.method??this._input.method),prefixUrl:String(t.prefixUrl||""),retry:U(t.retry),throwHttpErrors:t.throwHttpErrors!==!1,timeout:typeof t.timeout>"u"?1e4:t.timeout,fetch:t.fetch??globalThis.fetch.bind(globalThis)},typeof this._input!="string"&&!(this._input instanceof URL||this._input instanceof globalThis.Request))throw new TypeError("`input` must be a string, URL, or Request");if(this._options.prefixUrl&&typeof this._input=="string"){if(this._input.startsWith("/"))throw new Error("`input` must not begin with a slash when using `prefixUrl`");this._options.prefixUrl.endsWith("/")||(this._options.prefixUrl+="/"),this._input=this._options.prefixUrl+this._input}if(O){if(this.abortController=new globalThis.AbortController,this._options.signal){const s=this._options.signal;this._options.signal.addEventListener("abort",()=>{this.abortController.abort(s.reason)})}this._options.signal=this.abortController.signal}if(E&&(this._options.duplex="half"),this.request=new globalThis.Request(this._input,this._options),this._options.searchParams){const o="?"+(typeof this._options.searchParams=="string"?this._options.searchParams.replace(/^\?/,""):new URLSearchParams(this._options.searchParams).toString()),n=this.request.url.replace(/(?:\?.*?)?(?=#|$)/,o);(P&&this._options.body instanceof globalThis.FormData||this._options.body instanceof URLSearchParams)&&!(this._options.headers&&this._options.headers["content-type"])&&this.request.headers.delete("content-type"),this.request=new globalThis.Request(new globalThis.Request(n,{...this.request}),this._options)}this._options.json!==void 0&&(this._options.body=JSON.stringify(this._options.json),this.request.headers.set("content-type",this._options.headers.get("content-type")??"application/json"),this.request=new globalThis.Request(this.request,{body:this._options.body}))}_calculateRetryDelay(e){if(this._retryCount++,this._retryCount<this._options.retry.limit&&!(e instanceof C)){if(e instanceof w){if(!this._options.retry.statusCodes.includes(e.response.status))return 0;const s=e.response.headers.get("Retry-After");if(s&&this._options.retry.afterStatusCodes.includes(e.response.status)){let o=Number(s);return Number.isNaN(o)?o=Date.parse(s)-Date.now():o*=1e3,typeof this._options.retry.maxRetryAfter<"u"&&o>this._options.retry.maxRetryAfter?0:o}if(e.response.status===413)return 0}const t=.3;return Math.min(this._options.retry.backoffLimit,t*2**(this._retryCount-1)*1e3)}return 0}_decorateResponse(e){return this._options.parseJson&&(e.json=async()=>this._options.parseJson(await e.text())),e}async _retry(e){try{return await e()}catch(t){const s=Math.min(this._calculateRetryDelay(t),v);if(s!==0&&this._retryCount>0){await F(s,{signal:this._options.signal});for(const o of this._options.hooks.beforeRetry)if(await o({request:this.request,options:this._options,error:t,retryCount:this._retryCount})===k)return;return this._retry(e)}throw t}}async _fetch(){for(const e of this._options.hooks.beforeRequest){const t=await e(this.request,this._options);if(t instanceof Request){this.request=t;break}if(t instanceof Response)return t}return this._options.timeout===!1?this._options.fetch(this.request.clone()):N(this.request.clone(),this.abortController,this._options)}_stream(e,t){const s=Number(e.headers.get("content-length"))||0;let o=0;return e.status===204?(t&&t({percent:1,totalBytes:s,transferredBytes:o},new Uint8Array),new globalThis.Response(null,{status:e.status,statusText:e.statusText,headers:e.headers})):new globalThis.Response(new globalThis.ReadableStream({async start(n){const u=e.body.getReader();t&&t({percent:0,transferredBytes:0,totalBytes:s},new Uint8Array);async function i(){const{done:a,value:l}=await u.read();if(a){n.close();return}if(t){o+=l.byteLength;const m=s===0?0:o/s;t({percent:m,transferredBytes:o,totalBytes:s},l)}n.enqueue(l),await i()}await i()}}),{status:e.status,statusText:e.statusText,headers:e.headers})}}/*! MIT License © Sindre Sorhus */const b=r=>{const e=(t,s)=>f.create(t,d(r,s));for(const t of x)e[t]=(s,o)=>f.create(s,d(r,o,{method:t}));return e.create=t=>b(d(t)),e.extend=t=>b(d(r,t)),e.stop=k,e},B=b(),D=B;function H(r,e,t,s,o,n,u,i){var a=typeof r=="function"?r.options:r;e&&(a.render=e,a.staticRenderFns=t,a._compiled=!0),s&&(a.functional=!0),n&&(a._scopeId="data-v-"+n);var l;if(u?(l=function(c){c=c||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!c&&typeof __VUE_SSR_CONTEXT__<"u"&&(c=__VUE_SSR_CONTEXT__),o&&o.call(this,c),c&&c._registeredComponents&&c._registeredComponents.add(u)},a._ssrRegister=l):o&&(l=i?function(){o.call(this,(a.functional?this.parent:this).$root.$options.shadowRoot)}:o),l)if(a.functional){a._injectStyles=l;var m=a.render;a.render=function(S,_){return l.call(_),m(S,_)}}else{var p=a.beforeCreate;a.beforeCreate=p?[].concat(p,l):[l]}return{exports:r,options:a}}const z={mounted(){document.addEventListener("mave:select",r=>{if(this.searchModalIsOpen){const e=r.detail.querySelector("mave-img");this.update(e.getAttribute("embed")),this.searchModalIsOpen=!1}})},mixins:[Fieldtype],data(){return{searchModalIsOpen:!1,listType:"grid",query:"",result:null,loading:!1,token:this.meta.maveApi,theme:this.meta.maveTheme}},computed:{},methods:{openSearchModal(){this.searchModalIsOpen=!0},modalOpened(){this.$refs.query.$el.querySelector("input").focus()}}};var J=function(){var e=this,t=e._self._c;return t("div",[e.value?t("div",{staticClass:"mave-relative"},[t("mave-player",{staticClass:"mave-w-full mave-aspect-video mave-rounded-md mave-overflow-hidden",style:{"background-image":"url(//space-"+e.value.substr(0,5)+".video-dns.com/"+e.value.substr(5,14)+"/poster.jpg","background-size":"cover"},attrs:{embed:e.value,theme:e.theme}}),t("div",{staticClass:"mave-absolute mave-top-0 mave-left-0 mave-rounded-md mave-w-full mave-aspect-video mave-ring-1 mave-ring-inset mave-ring-black mave-ring-opacity-10 mave-pointer-events-none"}),t("div",{staticClass:"mave-absolute mave-right-4 mave-top-4 mave-bg-white mave-p-0.5 mave-rounded-md"},[t("dropdown-list",{attrs:{placement:"bottom-center"}},[t("dropdown-item",{attrs:{text:"Change"},on:{click:e.openSearchModal}}),t("dropdown-item",{attrs:{text:"Remove"},on:{click:function(s){return e.update(null)}}})],1)],1)],1):t("button",{staticClass:"btn",on:{click:e.openSearchModal}},[e._v("Browse videos")]),e.searchModalIsOpen?t("stack",{on:{closed:function(s){e.searchModalIsOpen=!1}},scopedSlots:e._u([{key:"default",fn:function({close:s}){return t("div",{staticClass:"mave-flex mave-flex-col mave-h-full mave-bg-white"},[t("header",{staticClass:"bg-white pl-6 pr-3 py-2 mb-4 border-b shadow-md text-lg font-medium flex items-center justify-between"},[e._v(" Select a video "),t("button",{staticClass:"btn-close",attrs:{type:"button"},on:{click:function(o){e.searchModalIsOpen=!1}}},[e._v("×")])]),t("div",{staticClass:"mave-px-6 mave-py-3 mave-flex-1 mave-flex mave-flex-col mave-overflow-hidden"},[t("mave-list",{staticClass:"mave-grid mave-w-full mave-grid-cols-5 mave-gap-3",attrs:{token:e.token}},[t("div",{staticClass:"relative mave-aspect-video mave-relative mave-rounded-lg mave-border mave-border-stone-100",attrs:{name:"mave-list-root"}},[t("div",{staticClass:"mave-w-full mave-h-full mave-flex mave-items-center mave-justify-center mave-text-3xl mave-font-bold mave-text-stone-400 mave-cursor-pointer",attrs:{slot:"root-link"},slot:"root-link"},[t("div",{staticClass:"mave-mb-4"},[e._v("...")])])]),t("div",{staticClass:"relative mave-aspect-video mave-relative mave-rounded-lg mave-bg-stone-100",attrs:{name:"mave-list-folder"}},[t("div",{staticClass:"mave-w-full mave-h-full mave-cursor-pointer",attrs:{slot:"folder-link"},slot:"folder-link"},[t("div",{staticClass:"mave-absolute mave--top-1 mave-w-8 mave-h-4 mave-bg-stone-100 mave-rounded-lg"}),t("div",{staticClass:"mave-w-32 mave-absolute mave-text-xs mave-left-2 mave-text-stone-400 mave-font-medium mave-top-1.5 mave-p-1 mave-truncate mave-h-6",attrs:{slot:"folder-title"},slot:"folder-title"}),t("div",{staticClass:"mave-absolute mave-text-xs mave-right-2 mave-text-stone-400 mave-bottom-1.5 mave-p-1 mave-truncate mave-h-6",attrs:{slot:"folder-count"},slot:"folder-count"})])]),t("div",{staticClass:"mave-aspect-video mave-relative mave-rounded-lg mave-bg-stone-100 mave-cursor-pointer mave-overflow-hidden",attrs:{name:"mave-list-item",onclick:"document.dispatchEvent(new CustomEvent('mave:select', {detail: this}))"}},[t("div",{staticClass:"mave-w-32 mave-absolute mave-text-xs mave-right-1.5 mave-text-white mave-bottom-1.5 mave-rounded-lg mave-bg-black mave-bg-opacity-60 mave-px-1.5 mave-py-1 mave-truncate mave-h-6",attrs:{slot:"item-title"},slot:"item-title"}),t("div",{staticClass:"mave-w-full mave-h-full mave-absolute mave-ring-1 mave-ring-inset mave-ring-black mave-ring-opacity-5 mave-rounded-lg"}),t("mave-img",{staticClass:"block"})],1)])],1)])}}],null,!1,2107261388)}):e._e()],1)},V=[],W=H(z,J,V,!1,null,null,null,null);const X=W.exports;window.ky=D;Statamic.booting(()=>{Statamic.$components.register("mave-fieldtype",X)});
